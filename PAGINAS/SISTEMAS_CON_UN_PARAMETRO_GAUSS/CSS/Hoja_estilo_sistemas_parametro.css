:root{--bg:#f5f7fb;--panel:#ffffff;--ink:#111827;--muted:#6b7280;--accent:#2563eb;--accent-2:#0ea5a4;--border:#d1d5db;--soft:#eef2f7;--shadow:0 6px 18px rgba(0,0,0,.08);--radius:12px;--radius-sm:8px;--gap:10px;--footerH:74px;}
*{box-sizing:border-box}
html,body{height:100%}
body{margin:0;padding:0!important;background:linear-gradient(180deg,var(--bg),#ffffff);color:var(--ink);font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,monospace;font-size:15px;display:flex;flex-direction:column;min-height:100vh;overflow:hidden;}
a{color:var(--accent);text-decoration:none}
a:hover{text-decoration:underline}
h1,h2,h3,h4,p{margin:0}

#tituloinicial{position:sticky;top:0;z-index:10;background:var(--panel);border-bottom:1px solid var(--border);box-shadow:0 2px 10px rgba(0,0,0,.04);display:flex;align-items:center;justify-content:space-between;gap:18px;padding:12px 16px;}
#tituloinicial h1{flex:1;display:flex;flex-direction:column;gap:4px;line-height:1.15;min-width:0;}
#tituloinicial .t1{font-size:18px;font-weight:900;letter-spacing:.2px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
#tituloinicial .t2{font-size:13px;font-weight:900;color:var(--muted);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
#tituloinicial .mini{font-weight:900;opacity:.9;}
#controlesTop{display:flex;align-items:center;gap:14px;flex:0 0 auto}
.abreVentana{font-size:14px;font-weight:800;padding:8px 10px;border-radius:var(--radius-sm);background:var(--soft);border:1px solid var(--border);}

#btnHome{display:inline-flex;flex-direction:column;align-items:center;justify-content:center;width:46px;height:50px;background:var(--soft);border:1px solid var(--border);border-radius:10px;gap:2px;transition:.15s transform,.15s background;}
#btnHome:hover{transform:translateY(-1px);background:#e9eef9}
#btnHome svg{display:block;fill:var(--ink)}
#btnHome span{font-size:9px;line-height:9px;color:var(--ink);font-weight:900;letter-spacing:.5px}

/* Contenedor principal: sin scroll; reserva el hueco del footer fixed */
#contenedor{flex:1 1 auto;min-height:0;width:100%;padding:var(--gap);padding-bottom:calc(var(--gap) + var(--footerH));display:flex;flex-direction:column;gap:var(--gap);overflow:hidden;}

/* Caja 1 */
#caja1{background:var(--panel);border:1px solid var(--border);border-radius:var(--radius);box-shadow:var(--shadow);padding:10px;min-width:0;flex:0 0 auto;}

/* Panel matriz (caja2 con botón) */
#panelMatriz{background:var(--panel);border:1px solid var(--border);border-radius:var(--radius);box-shadow:var(--shadow);padding:10px;min-width:0;flex:0 0 auto;}
#barraMatriz{display:flex;align-items:center;justify-content:space-between;gap:10px}
#titulo3{margin:0;font-size:12px;font-weight:900;color:var(--muted);letter-spacing:.6px;text-transform:uppercase;flex:1;min-width:0}
#caja2{margin-top:8px}
#panelMatriz.oculto #caja2{display:none}
#panelMatriz.oculto #btnToggleTrabajos{background:linear-gradient(90deg,var(--accent),var(--accent-2));color:#fff;border-color:transparent}
/* Botón trabajos: solo aparece al llegar a escalonada */
#btnToggleTrabajos{display:none}
body.escalonada #btnToggleTrabajos{display:inline-flex}
body.trabajosOcultos #contenedorCaja3{display:none}


/* Caja 3: única con scroll y ocupa el alto sobrante */
#contenedorCaja3{flex:1 1 auto;min-height:0}
#caja3{height:100%;overflow-y:auto;display:flex;flex-wrap:wrap;align-content:flex-start;background:var(--panel);border:1px solid var(--border);border-radius:var(--radius);box-shadow:var(--shadow);padding:10px;min-width:0;}
#caja31{margin:10px}

/* Inputs/tabla/botones */
table{table-layout:auto;border-spacing:7px;font-size:14px;margin:0;padding:0}
td{padding:0 3px;text-align:right;width:auto}
input{width:30px;padding:4px 6px;border:1px solid var(--border);border-radius:6px;background:white;font-weight:800;color:var(--ink);outline:none;transition:border-color .12s,box-shadow .12s;}
input:focus{border-color:var(--accent);box-shadow:0 0 0 3px rgba(37,99,235,.12)}
label{margin-right:10px}
button{appearance:none;border:1px solid var(--border);background:var(--soft);padding:7px 10px;border-radius:8px;font-weight:900;font-size:12px;cursor:pointer;transition:.12s transform,.12s background,.12s border-color;}
button:hover{transform:translateY(-1px);background:#e9eef9;border-color:#c7d2fe}
button:active{transform:translateY(0)}
#botonautomatico{background:linear-gradient(90deg,var(--accent),var(--accent-2));color:white;border-color:transparent;}
#botonautomatico:hover{filter:brightness(1.03)}

/* Ventana ayuda */
.ventana{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,0.55);justify-content:center;align-items:center;z-index:1000;padding:14px;}
.contenidoVentana{background-color:white;padding:18px;border-radius:var(--radius);width:min(900px,92vw);text-align:center;position:relative;box-shadow:0 18px 50px rgba(0,0,0,.22);}
.contenidoVentana h2{font-size:18px;font-weight:900;margin-bottom:10px}
.cierraVentana{position:absolute;top:10px;right:12px;font-size:22px;cursor:pointer;width:32px;height:32px;display:flex;align-items:center;justify-content:center;border-radius:50%;background:var(--soft);border:1px solid var(--border);}
iframe{border:none}

/* KaTeX/MathJax */
.mjx-math{font-size:14px;font-family:monospace}
.katex .op-limits>.vlist-t{text-align:center;font-weight:600}

/* Responsive */
@media (max-width:700px){
  #tituloinicial{flex-direction:column;align-items:stretch}
  #controlesTop{justify-content:flex-end}
  #tituloinicial .t1,#tituloinicial .t2{white-space:normal;overflow:visible;text-overflow:clip}
}

/* ===== Responsive (móvil/tablet) ===== */
@media (max-width: 900px){
  #contenedor{width:100% !important;padding:12px !important;}
  #caja1,#caja2{width:100% !important;max-width:100% !important;}
  #caja2{padding:12px !important;}
  #caja21{max-width:100% !important;overflow-x:auto !important;-webkit-overflow-scrolling:touch;}
}
@media (max-width: 700px){
  #caja1{padding:12px !important;}
  #caja1 input,#caja1 select,#caja1 textarea{max-width:100% !important;}
}
